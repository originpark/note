---
typora-root-url: ./..\..\images
---

# linux目录结构

`/` 根目录,根目录下是名称固定,不可随意更改名称的子目录

`/bin` 存放常用的linux命令

`/sbin` 存放系统管理员能够使用的的命令

`/home` 管理员可查看,存放每个普通用户的主目录,每个用户的主目录以用户名命名

`/etc` 系统管理所需的配置文件

`/usr` 存放应用程序和文件

`/usr/local` 应用程序的安装目录

`/boot` 启动linux的核心文件

`/dev` 设备管理器,例如将所有硬件映射为文件夹来管理

`/mnt` 将外部存储挂载到mnt文件夹中,就可以在该文件夹中读写这些挂载的内容

`/opt` 将安装文件存放在该目录,注意不是应用程序,而是应用程序的安装文件

`/var` 存放日志等





# 关机

```
shotdown -h now //立即关机
shotdown -h 2   //两分钟后关机
shotdown -r new //立即重启
halt            //立即关机
reboot          //立即重启
sync            //把内存的数据同步到磁盘,建议在关机之前执行以下sync
```





# 切换用户/注销

```
su - 用户名  //切换到其他用户
logout     //登出当前用户,回到上一级用户,如果没有上一级目录则会退出系统
```





# 用户管理

用户管理需要有管理员权限

## 添加用户

```
useradd 用户名           //创建用户,默认家目录在/home下
useradd -d 家目录 用户名  //创建用户,并指定其家目录所在目录
```



## 指定/修改密码

```
password 用户名    //给指定用户名修改密码
```



## 删除用户

```
userdel 用户名     //删除用户,保留家目录
userdel -r 用户名  //删除用户,不保留家目录
```



## 查询用户信息

```
id 用户名
who am i
```



## 修改用户信息

```
usermod -g group01 用户名
```



## 用户组

```
groupadd 组名          //新增组
groupdel 组名          //移除组
useradd -g 组名 用户名  //添加新用户时指定其组名,如果不指定则默认创建一个与用户名同名的组并将该用户放入该组
```





# 运行级别

linux运行级别:

- 0: 关机
- 1: 单用户
- 2: 多用户,无网络
- 3: 多用户,有网络
- 4: 系统未使用保留给用户
- 5: 图形界面
- 6: 系统重启



`init 序号`来切换不同运行级别

`system get-default`获取当前运行级别

`system set-default graphical.target`设置每次启动时的默认运行级别





# linux指令



## 帮助指令

`man xxx` 获取xxx指令的帮助信息



## 文件目录指令

`pwd` 显示当前工作目录的绝对路径

`cd ~`回到自己的家目录

`cd ..`返回上一级目录

`mkdir` 创建一级目录

`mkdir -p` 创建多级目录

`rmdir` 删除空文件夹

`rm -rf` -r表示删除整个目录, -f表示强制删除不提示

`touch` 创建一个空文件

`cp 文件名 目录名` 拷贝文件到指定目录

`cp -r 拷贝目录 目标路径目录` 拷贝目录到指定目录

`\cp` 复制时覆盖所有同名文件

`mv 旧文件名 新文件名` 重命名文件

`mv 文件名 目录名` 移动文件到指定目录

`cat 文件名` 查看文件内容 

`more 文件名` 查看文件内容

`less` 文件名  同more

`echo` 打印内容到控制台

`head -n 5 文件名` 显示文件的开头n行, 默认显示前十行

`tail -n 6 文件名` 显示文件的结尾n行, 默认显示后十行

`echo "xxx" > 文件名`  输出重定向到指定文件(覆盖原文件)

`cat 文件名 >> 文件名` 将cat显示的文件重定向追加到指定目录

`ln -s 文件名 软链接路径/软链接名` 给文件创建一个软链接,类似于快捷方式

`history 10` 查看最近的10条历史操作

`cal` 查看日历

`cal 2022` 查看2020年整年的日历





## 时间日期指令

- `date` 年月日 星期 时分秒
- `date +%Y-%m-%d` 显示年月日xxxx-xx-xx
- `data -s 2022-9-29 "16:07:00"` 设置系统当时间





## 搜索查找指令

`find /home -name *.txt` 查找/home目录下的所有txt文件

`find /opt -user root` 查找/opt目录下的root用户的所有文件

`find /home -size +200M` 查找/home目录下大小大于200MB的文件(+大于,-小于,不写符号为等于;单位有k,M,G)

`updatedb` 更新检索数据库,配合locate指令使用

`locate 文件名` 查找文件所在目录,执行locate前必须先执行一次updatedb指令

`which 指令名` 查看某个指令在哪个目录下

`cat 文件 | grep "111"` 查找文件中的"111",grep表示过滤查找

`grep "111" 文件` 作用同上



## 压缩和解压

`gzip 文件` 将文件压缩为.gz文件

`gunzip 文件` 解压.gz文件

`zip -r` zip也是压缩指令,-r表示压缩整个文件夹

`unzip -d 路径` 解压到指定路径

`tar 文件` 打包指令,打包后的文件为.tar.gz文件,可添加以下选项

	- `-c`  产生.tar打包文件
	- `-v`  显示详细信息
	- `-f`  指定压缩后的文件名
	- `-z`  打包同时压缩
	- `-x`  解包.tar文件

`tar 文件 -C 路径` 将文件解压到指定路径







# vim

## 三种模式

- `正常模式` 默认模式,该模式下可以对文件进行处理,例如复制,粘贴,在其他任意模式下,输入`esc`可以回到正常模式
- `插入模式` 正常模式下按下`i`进入插入模式,该模式下可以进行文本编辑
- `命令行模式` 在正常模式下,输入输入`:`进入命令行模式,该模式下可以执行保存,退出等命令,在命令行模式下每执行一次命令后,就会自动进入正常模式

### 命令行模式
- `q` 退出
- `w` 保存
- `wq` 保存并退出
- `/xxx` 在文本中搜索xxx,按n定位到下一个
- `set nu` 显示当前行号
- `set nonu` 关闭显示当前行号

### 正常模式

- `yy` 拷贝当前1行
- `5yy` 向下拷贝5行
- `p` 粘贴至当前行的下一行
- `dd` 删除当前行
- `5dd` 删除向下5行
- `G` 定位到文件最末行
- `gg` 定位到文件首行
- `u` 撤销
- 先输入行号,再输入`shift + g` 可以定位到该行



# 组管理和权限管理

linux中的每个用户必须属于一个组

linux中的每个文件都有所有者,所在组,其他组的概念



## 查看文件/目录所有者

`ls -ahl` 查看当前目录下的文件及其所有者(创建者)



## 创建组/组内用户

`groupadd 组名` 创建组

`useradd -g 组名 用户名` 在组内创建用户



## 修改用户所在的组

`usermod -g 新组名 用户名` 修改用户所在的组



## 权限

### 文件权限说明

`ls -l`显示当前目录下的文件格式如下

```
-rw-r--r--. 1 root root    7 9月  28 20:25 Hello.java
```

第0位(第一个字符)表示文件类型

- `l` 软链接(快捷方式)
- `d` 目录
- `-` 普通文件
- `c` 设备文件,如鼠标,键盘
- `b` 块设备,如硬盘

第1~3位表示文件所有者对文件的权限,w表示写,r表示读,x表示执行

第4~6位表示同组内用户对改文件的权限

第7~9位表示其他组的用户对改文件的权限

数字1: 对文件来说表示链接数,对目录来说表示子目录数

数字7: 表示文件大小,单位是字节

日期表示最后修改的日期





**注意**

w作用到文件:

- w表示可修改,但不代表可以删除(是否有删除权限要看用户是否对改文件所在目录有w权限)

wrx作用到文件夹:

		-  x表示可以进入到该目录
		-  r表示可以列出目录内容
		-  可以修改目录,在目录内创建,删除,重命名文件



### 修改用户对文件的权限

`chmod u=rwx,g=rx,o=x 文件/目录` 修改不同用户对文件的权限,u表示所有者,g表示同组用户,o表示其他组用户,a表示所有人

`chmod o+x 文件/目录` 表示给其他用户添加执行权限

`chmod a-x 文件/目录` 表示给所有用户取消执行权限



**通过数字修改文件权限**

r=4, w=2, x=1

`chmod 751 文件` 表示所有者的权限是4+2+1,即rwx,同组用户的权限是4+1,即r+x,其他组用户的权限是1,即x





### 修改文件所有者

`chown 用户 文件` 修改文件的所有者

`chown -R 用户 目录` 递归修改目录及其目录下的所有文件的所有者



### 修改文件所在组

`chgrp 组名 文件` 修改文件的所在组





# 定时任务调度

`crontab -e` 编辑任务调度文件

`crontab -l` 查询任务调度

`crontab -r` 删除任务调度



## 编辑任务调度文件

首先执行`crontab -e`

然后开始编辑任务调度文件

```
* * * * * ls -l /tec/ > /tmp/to.txt
```

前部分为任务执行的周期时间,后部分为要执行的任务



### 占位符

五个占位符用于确定后面的任务执行的事件周期:

第一个: 表示一小时当中的第几分钟

第二个: 表示一天当中的第几个小时,`*`表示每个小时

第三个: 表示一个月当中的第几天

第四个: 表示一年当中的第几个月

第五个: 表示星期几,0和7都表示星期日



### 特殊符号

每一个占位符中不仅可以填入一个数字,还可以填入多个数字来表示多个时间点,每个时间点用逗号隔开,例如

```shell
*/18,12,6***
```

表示在每天的18,12,6点执行一次命令

与`,`相对,`-`表示连续的事件段

`*/n`表示每隔多久时间,例如第一个占位符中的`*/1`则表示每隔一分钟执行一次



## at定时任务

at命令是一次性定时任务,执行一个叫做job队列中的任务,每个任务只执行一次

at有一个守护进程atd,atd在默认情况下每隔60秒检查一次job队列,看是否有需要执行的任务然后执行,执行完的任务被移出job队列



### 设置任务

`at 5pm + 2days` 表示两天后的下午5点,然后按下回车,系统会让我们输入需要执行的命令,输入完之后,再按两次`ctrl + D`完成操作

`at 5pm tomorrow` 表示明天下午5点



##  查看任务

`atp` 查看当前at任务





# 磁盘分区&挂载



`lsblk` 查看分区挂载情况

`df -h` 查看磁盘使用情况

`du -s -h -c -a --max-depth=1` 查看指定目录的磁盘占用情况,-s显示指定目录占用大小汇总,-h带计量单位,-a含文件,--max-depth子目录深度,-c列出明细的同时增加汇总值





# 进程

## 查看进程

`ps -aux` 查看当前进程

`pstree -p` 树状显示进程



## 终止进程

`kill 进程号` 通过进程号终止进程

`killall 进程名` 通过进程名终止进程及该进程的所有子进程

选项:

`-9` 强制终止进程





# 服务管理

`service 服务名 start | stop | restart | reload | status`

`systemctl is-enabled 服务名` 查看服务是否启动

`systemctl enabled 服务名` 设置服务开机启动

`systemctl disabled 服务名` 关闭服务开机启动

`systemctl status 服务名` 查看当前服务状态

`systemctl stop 服务名` 关闭服务

`firewall-cmd --permanent --add-port=端口号/协议` 打开防火墙中的某个端口

`firewall-cmd --permanent --remove-port=端口号/协议` 关闭防火墙中的某个端口

`firewall-cmd --reload ` 重新加载

`firewall-cmd --query-port=端口号/协议` 查询防火墙中的某个端口是否打开



# 动态监控进程

`top -d 秒数 -i -p` -d指定top指令每隔几秒更新 -i使不显示任何闲置或僵死进程





# rpm&yum

.rpm文件类似于win中的软件安装包,yum类似于前端的包管理工具npm

`rpm -qa` 显示当前已安装的rpm列表

`rpm -q 软件包名` 查看软件包是否安装

`rpm -qi 软件包名` 查看软件包信息

`rpm -ql 软件包名` 查看软件安装位置及相关文件

`rpm -e 包名` 卸载某个软件

`rpm -ivh rpm包路径` 安装rpm包

`yum list|grep xx` 查询yum服务器是否有需要安装的软件

`yum install xx` 安装软件  





# shell

shell是命令行解释器,.sh文件默认用于编写命令行,通过执行.sh脚本来执行命令

.sh文件的第一行需要写`#!/bin/bash`

`sh xxx.sh` 执行脚本,无需有执行权限





## shell变量

shell变量分为系统变量和自定义变量



定义变量

```shell
A=666
```

使用变量

```shell
# 输出变量A
echo $A 
```

撤销变量

```shell
unset $A
```

声明静态变量,静态变量不可被unset

```shell
readonly B=2
```

将命令的返回值赋值给变量,加上``

```shell
A=`date`
A=$(date)
```



**配置环境变量**

在/etc/profile文件中定义环境变量/全局变量

```shell
export JAVA_HOME=/opt/java/bin
```

刷新文件

```shell
source /tec/profile
```



## 位置参数

执行脚本时可以在后面追加参数

```
./myShell.sh 100 200
```



在脚本文件中,使用`$0`表示命名本身,`$1`表示第一个参数,`$2`表示第二个参数...

`$*`和`$@`表示所有参数,`$#`表示参数的个数



## 预定义变量

`$$` 当前进程的进程号

`$!` 后台运行的最后一个进程的进程号

`$?` 最后一次执行的命令的返回状态



## 运算符

运算表达式写在`$[]`中

```shell
RESULT1=$[1+1]
```



## if

```shell
if [ "ok" = "ok" ]
then echo "wqual"
elif [  ]
then
fi
```



## case

```shell
case $1 in
"1")
echo "周一"
;;
"2")
echo "周二"
;;
*)
echo "其他"
;;
esac
```





## for

```shell
for i in "$*"
do
	echo "num is $i"
done
```



```shell
SUM=0
for (( i=1; i<=100; i++))
do SUM=$[ $SUM+$i ]
done
echo $SUM
```



## while

```shell
while [  ]
do
done
```



## read

读取键盘输入

```shell
read -p "请输入一个数: " num1
```





# 日志

